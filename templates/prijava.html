<!DOCTYPE html>
<html lang="sl">
<head>
    <!-- Title -->
    <title>FitRise Slovenija: Tvoje želje, naš cilj</title>
    <!-- Ikona -->
    <link rel="icon" href="{{ url_for('static', filename='Gym.ico') }}" type="image/x-icon">
    <!-- Povezava css -->
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
    <!-- kodiranje avtor itd -->   
    <meta charset="utf-8">
    <meta name="description" content="FitRise Slovenija: Tvoje želje, naš cilj">
    <meta name="author" content="FitRiseSlovenija, Jošt Košir, Teo Makarič">
    <!-- zdruzljivost z brskalniki privzeta velikost elementov -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <!-- bootstrap css -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <!-- jquery, bootstrap js -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <!-- Ikone Font Awesome -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <!-- pisava Google Fonts: Roboto -->
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">
    <!-- login kontejner css -->
    <link rel="stylesheet" href="{{ url_for('static', filename='login.css') }}">
</head>
<body>
    <div class="content">
        <!-- Header z navigacijo -->
        

        <!-- Login obrazec -->
        <div class="container text-center">
            <h1>Prijava</h1>
            
            <div id="error-message" style="color: red; display: none;"></div>
            
            <div id="login-container">
                
                <form action=/Login method="post">
                
                
                <div>
                    <label for="username">Uporabniško ime:</label>
                    <input type="text" placeholder="ime" name="username" id="username" required class="form-control">
                </div>
                
                <div>
                    <label for="password">Geslo:</label>
                    <input type="password" placeholder="geslo" name="password" id="password" required class="form-control">
                </div>
                
                <div>
                    <button>Prijava</button>
                </div>
                </form>
            </div>
        </div>
    </div>
    <div class="content">
        <!-- Header z navigacijo -->
        

        <!-- Login obrazec -->
        <div class="container text-center">
            <h1>Registracija</h1>
            
            <div id="error-message" style="color: red; display: none;"></div>
            
            <div id="login-container">
                
                <form action="/Register" method="post">
                
                <div>
                    <label for="username">Uporabniško ime:</label>
                    <input type="text" placeholder="ime" name="username" id="username" required class="form-control">
                </div>
                
                <div>
                    <label for="password">Geslo:</label>
                    <input type="password" placeholder="geslo" name="password" id="password" required class="form-control">
                </div>
                
                <div>
                    <button>Registracija</button>
                </div>
                </form>
            </div>
        </div>
    </div>
    <!-- Footer z informacijami -->
    

    <!-- JavaScript za prijavo -->
    <script>
        function loginOrRegister() {
            const username = document.getElementById('username').value.trim();
            const password = document.getElementById('password').value.trim();
            const errorMessage = document.getElementById('error-message');
            
            if (username === '' || password === '') {
                errorMessage.textContent = 'Uporabniško ime in geslo sta obvezna!';
                errorMessage.style.display = 'block';
                return;
            }
            
            errorMessage.style.display = 'none';
            
            $.ajax({
                url: '/login',
                type: 'POST',
                data: {
                    username: username,
                    password: password
                },
                dataType: 'json',
                success: function(response) {
                    if (response.success) {
                        // Preusmeri na glavno stran
                        window.location.href = '/';
                    } else {
                        // Prikaži sporočilo o napaki
                        errorMessage.textContent = response.error;
                        errorMessage.style.display = 'block';
                    }
                },
                error: function(xhr, status, error) {
                    console.error('Podrobnosti napake:', xhr.responseText);
                    errorMessage.textContent = 'Prišlo je do napake. Poskusite znova.';
                    errorMessage.style.display = 'block';
                }
            });
        }

        document.getElementById('username').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                loginOrRegister();
            }
        });
        
        document.getElementById('password').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                loginOrRegister();
            }
        });
    </script>
    {% if error %}
        <script>
            alert("{{ error }}");
        </script>
    {% endif %}
</body>
</html>
